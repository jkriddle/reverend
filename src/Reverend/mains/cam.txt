#include "ltimer.h"
#include <iostream>

const int FPS = 60;
const int DELAY_TIME = 1000.0f / FPS;
const int SCREEN_FPS = 60;
const int SCREEN_TICKS_PER_FRAME = 1000 / SCREEN_FPS;

void ff(const std::string& s) {
}

int main(int argc,char **argv) 
{	
	
    //The frames per second timer
    LTimer fpsTimer;

    //The frames per second cap timer
    LTimer capTimer;
	
    //Start counting frames per second
    int countedFrames = 0;
    fpsTimer.start();
	bool quit = false;
	SDL_Event e;
	while (!quit) {
		//Handle events on queue
		while( SDL_PollEvent( &e ) != 0 )
		{
			//User requests quit
			if( e.type == SDL_QUIT )
			{
				quit = true;
			}
		}
		ff("S");

        //Calculate and correct fps
        float avgFPS = countedFrames / ( fpsTimer.getTicks() / 1000.f );
        if( avgFPS > 2000000 )
        {
            avgFPS = 0;
        }
                ++countedFrames;

		//If frame finished early
        int frameTicks = capTimer.getTicks();
        if( frameTicks < SCREEN_TICKS_PER_FRAME )
        {
            //Wait remaining time
            SDL_Delay( SCREEN_TICKS_PER_FRAME - frameTicks );
        }
	}
	return 0;
}